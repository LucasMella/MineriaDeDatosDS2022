<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.1.189">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Taller 1 - Minería de Datos</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Taller 1_files/libs/clipboard/clipboard.min.js"></script>
<script src="Taller 1_files/libs/quarto-html/quarto.js"></script>
<script src="Taller 1_files/libs/quarto-html/popper.min.js"></script>
<script src="Taller 1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Taller 1_files/libs/quarto-html/anchor.min.js"></script>
<link href="Taller 1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Taller 1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Taller 1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Taller 1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Taller 1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Taller 1 - Minería de Datos</h1>
</div>



<div class="quarto-title-meta">

    
    
  </div>
  

</header>

<section id="cargar-los-datos" class="level2">
<h2 class="anchored" data-anchor-id="cargar-los-datos">0. Cargar los Datos</h2>
<p>En este taller trabajaremos con datos obtenidos de estaciones climaticas en Chile. Estos presentan información de variables como la temperatura, la precipitación, la velocidad del viento.</p>
<p>Se cargan los Datos de las estaciones agromet y AGV, además de sus respectivos dataframes con metadata asociada.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mascaras</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>mask_agv <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../data/data_raw/station_id_agv_Lucas.rds"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>mask_agromet <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../data/data_raw/station_id_agromet_Lucas.rds"</span>)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="co">#Sets de datos</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>agv_meta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../data/data_raw/metadata_estaciones_agvAPI.rds"</span>)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>api_agv <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../data/data_raw/data_agvAPI.rds"</span>)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>api_agromet <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../data/data_raw/data_estaciones_agrometAPI.rds"</span>)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>agromet_meta <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="st">"../data/data_raw/metadata_estaciones_agrometAPI.rds"</span>)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="co">#Aplicación de máscaras</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>agromet_meta <span class="ot">&lt;-</span> agromet_meta[agromet_meta<span class="sc">$</span>ema <span class="sc">%in%</span> mask_agromet,]</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>agv_meta <span class="ot">&lt;-</span> agv_meta[agv_meta<span class="sc">$</span>serial <span class="sc">%in%</span> mask_agv,]</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>api_agromet <span class="ot">&lt;-</span> api_agromet[api_agromet<span class="sc">$</span>station_id <span class="sc">%in%</span> mask_agromet,]</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>api_agv_rows <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">rownames</span>(agv_meta[agv_meta<span class="sc">$</span>serial <span class="sc">%in%</span> mask_agv,]))</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>api_agv <span class="ot">&lt;-</span> api_agv[<span class="fu">c</span>(api_agv_rows)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="reconocimiento-de-tipos-y-estructuras-de-datos" class="level2">
<h2 class="anchored" data-anchor-id="reconocimiento-de-tipos-y-estructuras-de-datos">1. Reconocimiento de tipos y estructuras de datos</h2>
<p>Utilizamos la función class para reconocer las estructuras de los datos importados</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(agromet_meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(agv_meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(api_agromet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "tbl_df"     "tbl"        "data.frame"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(api_agv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "list"</code></pre>
</div>
</div>
<p>Vemos que 3 sets de datos tienen estructura de dataframe, mientras que uno es una lista anidada o “Large list”</p>
</section>
<section id="saber-cantidad-de-variables-de-cada-estación-para-los-datos-de-agv" class="level2">
<h2 class="anchored" data-anchor-id="saber-cantidad-de-variables-de-cada-estación-para-los-datos-de-agv">2. Saber cantidad de variables de cada estación para los datos de AGV</h2>
<p>Dado que el set de datos de AGV presenta estructura de lista anidada, iteramos con lapply y ejecutamos la funcion unlist desanidarlo.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>df_agv <span class="ot">&lt;-</span> <span class="fu">lapply</span>(api_agv, unlist)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Luego, iteramos dentro de la lista resultante y utilizamos la función length para saber la cantidad de variables. Además, generamos un daraframe con estos datos, el cual trasponemos para una mejor visualización.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>df_agv <span class="ot">&lt;-</span> <span class="fu">lapply</span>(df_agv, length)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>df_agv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(<span class="fu">t</span>(df_agv)), <span class="at">row.names =</span> <span class="fu">c</span>(mask_agv))</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>df_agv</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            V1
z6-08661  3758
z6-08769  3758
z6-15297 18772
z6-08652  3758
z6-08765  3758
z6-10059  3758
z6-10056  3758
z6-08763  3758
z6-10097  3758
z6-08675  3758
z6-08681  4122
z6-10298 18772
z6-08657 18286
z6-08655  3758
z6-12948 18772
z6-10096  4606
z6-12797 17308
z6-12950 18772
z6-08759  3758
z6-08788  3758
z6-08786  3758
z6-08668  3758
z6-10058  3758
z6-08724  8202
z6-08667  3758
z6-08770  3758
z6-08689  3758
z6-08650  3758
z6-08774     8
z6-08729  3758
z6-12914 18772
z6-10052  3758
z6-08654  3758
z6-08767  3758
z6-08768 14918
z6-10092  3758
002035D7  5581
00203E6F 31514
01102B76  3272
00203D29  6458
00204FF2 22540
002090A9 12934
002035D6 12937
00203B04  6436
00203E78 12934
0020361D  6454
z6-08685  3758
z6-08683  3758
z6-08665  3758</code></pre>
</div>
</div>
</section>
<section id="calcular-suma-diaria-de-precipitaciones-y-promedio-diario-de-temperatura-para-los-datos-de-agromet" class="level2">
<h2 class="anchored" data-anchor-id="calcular-suma-diaria-de-precipitaciones-y-promedio-diario-de-temperatura-para-los-datos-de-agromet">3. Calcular suma diaria de precipitaciones y promedio diario de temperatura para los datos de agromet</h2>
<p>Para calcular la suma diaria de precipitaciones comenzamos agrupando por día los datos, ya que en los dataset se encuentran por hora, para ello, y por conveniencia, comenzamos seleccionando solo las columnas que vamos a trabajar para luego agregar una columna con la fecha truncada hasta el día.</p>
<p>Luego con el uso de un tapply sumamos los datos diarios.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>agromet_agr <span class="ot">&lt;-</span> api_agromet[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="dv">9</span>, <span class="dv">10</span>)]</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>agromet_agr<span class="sc">$</span>dia <span class="ot">&lt;-</span> <span class="fu">format</span>(api_agromet<span class="sc">$</span>fecha_hora, <span class="st">"%d-%m-%Y"</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>pdiaria <span class="ot">&lt;-</span> <span class="fu">tapply</span>(agromet_agr<span class="sc">$</span>precipitacion_horaria, agromet_agr<span class="sc">$</span>dia, sum, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="co">#agromet_agr$precipitacion_diaria &lt;- pdiaria</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="creacion-de-data-frame-tipo-tibble-con-variable-de-precipitacion-acumulada-diaria-y-temperaturas." class="level2">
<h2 class="anchored" data-anchor-id="creacion-de-data-frame-tipo-tibble-con-variable-de-precipitacion-acumulada-diaria-y-temperaturas.">4. Creacion de data frame tipo tibble con variable de precipitacion acumulada diaria y temperaturas.</h2>
<p>Importamos la librería tibble y luego creamos un dataframe tipo tibble con la variable de precipitación acumulada diaria y la suma de las temperaturas.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tibble' was built under R version 4.1.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tibble_api_agromet <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(agromet_agr)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tibble_api_agromet</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1,188,096 x 5
   station_id precipitacion_horaria temp_minima temp_maxima dia       
        &lt;dbl&gt;                 &lt;dbl&gt;       &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;     
 1          1                     0        20.4        20.4 01-01-2021
 2          1                     0        20.4        20.4 01-01-2021
 3          1                     0        20.4        20.4 01-01-2021
 4          1                     0        20.4        20.4 01-01-2021
 5          1                    NA        NA          NA   01-01-2021
 6          1                     0        22.2        23.1 01-01-2021
 7          1                     0        23.2        24.6 01-01-2021
 8          1                     0        24.7        25.6 01-01-2021
 9          1                     0        25.6        25.9 01-01-2021
10          1                     0        26.7        27.3 01-01-2021
# ... with 1,188,086 more rows</code></pre>
</div>
</div>
</section>
<section id="creacion-de-data-frames-tipo-tibble-con-variable-humedad-de-suelo-promedio-diaria-a-30cm-60cm-y-90cm-y-variable-de-temperatura-promedio-maxíma-y-mínima-diaria-y-precipitación-acumulada-diaria." class="level2">
<h2 class="anchored" data-anchor-id="creacion-de-data-frames-tipo-tibble-con-variable-humedad-de-suelo-promedio-diaria-a-30cm-60cm-y-90cm-y-variable-de-temperatura-promedio-maxíma-y-mínima-diaria-y-precipitación-acumulada-diaria.">5. Creacion de data frames tipo tibble con variable humedad de suelo promedio diaria a 30cm, 60cm y 90cm y variable de temperatura promedio, maxíma y mínima diaria; y precipitación acumulada diaria.</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">"PREGUNTA CANCELADA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "PREGUNTA CANCELADA"</code></pre>
</div>
</div>
</section>
<section id="información-resumida-de-datos." class="level2">
<h2 class="anchored" data-anchor-id="información-resumida-de-datos.">6. Información resumida de datos.</h2>
<p>Se entrega la información resumida de todos los set de datos y además incluímos la cantidad de datos NA.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(tibble_api_agromet)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   station_id    precipitacion_horaria  temp_minima      temp_maxima    
 Min.   :  1.0   Min.   : 0.00         Min.   :-44.00   Min.   :-39.60  
 1st Qu.:100.8   1st Qu.: 0.00         1st Qu.:  7.70   1st Qu.:  8.60  
 Median :209.5   Median : 0.00         Median : 11.80   Median : 12.70  
 Mean   :242.2   Mean   : 0.05         Mean   : 12.52   Mean   : 13.62  
 3rd Qu.:335.8   3rd Qu.: 0.00         3rd Qu.: 16.90   3rd Qu.: 18.30  
 Max.   :682.0   Max.   :58.00         Max.   : 98.30   Max.   :120.00  
                 NA's   :163172        NA's   :163172   NA's   :163172  
     dia           
 Length:1188096    
 Class :character  
 Mode  :character  
                   
                   
                   
                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(api_agromet))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3791502</code></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(api_agv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Length Class  Mode
 [1,] 2      tbl_df list
 [2,] 2      tbl_df list
 [3,] 2      tbl_df list
 [4,] 2      tbl_df list
 [5,] 2      tbl_df list
 [6,] 2      tbl_df list
 [7,] 2      tbl_df list
 [8,] 2      tbl_df list
 [9,] 2      tbl_df list
[10,] 2      tbl_df list
[11,] 2      tbl_df list
[12,] 2      tbl_df list
[13,] 2      tbl_df list
[14,] 2      tbl_df list
[15,] 2      tbl_df list
[16,] 2      tbl_df list
[17,] 2      tbl_df list
[18,] 2      tbl_df list
[19,] 2      tbl_df list
[20,] 2      tbl_df list
[21,] 2      tbl_df list
[22,] 2      tbl_df list
[23,] 2      tbl_df list
[24,] 2      tbl_df list
[25,] 2      tbl_df list
[26,] 2      tbl_df list
[27,] 2      tbl_df list
[28,] 2      tbl_df list
[29,] 2      tbl_df list
[30,] 2      tbl_df list
[31,] 2      tbl_df list
[32,] 2      tbl_df list
[33,] 2      tbl_df list
[34,] 2      tbl_df list
[35,] 2      tbl_df list
[36,] 2      tbl_df list
[37,] 2      tbl_df list
[38,] 2      tbl_df list
[39,] 2      tbl_df list
[40,] 2      tbl_df list
[41,] 2      tbl_df list
[42,] 2      tbl_df list
[43,] 2      tbl_df list
[44,] 2      tbl_df list
[45,] 2      tbl_df list
[46,] 2      tbl_df list
[47,] 2      tbl_df list
[48,] 2      tbl_df list
[49,] 2      tbl_df list</code></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(api_agv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(agromet_meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ema        institucion         nombre_ema           comuna         
 Min.   :  1.0   Length:136         Length:136         Length:136        
 1st Qu.:100.8   Class :character   Class :character   Class :character  
 Median :209.5   Mode  :character   Mode  :character   Mode  :character  
 Mean   :242.2                                                           
 3rd Qu.:335.8                                                           
 Max.   :682.0                                                           
    region             latitud          longitud     
 Length:136         Min.   :-53.07   Min.   :-73.67  
 Class :character   1st Qu.:-37.88   1st Qu.:-72.14  
 Mode  :character   Median :-34.79   Median :-71.26  
                    Mean   :-35.06   Mean   :-71.40  
                    3rd Qu.:-33.11   3rd Qu.:-70.75  
                    Max.   :-18.51   Max.   :-68.01  
 fecha_de_alta                
 Min.   :2013-03-08 06:49:10  
 1st Qu.:2013-03-08 06:49:11  
 Median :2013-03-08 06:49:12  
 Mean   :2014-06-24 04:52:57  
 3rd Qu.:2016-01-13 16:49:25  
 Max.   :2020-03-30 15:36:37  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(agromet_meta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(agv_meta)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    nombre             serial               lat              lon        
 Length:49          Length:49          Min.   :-37.78   Min.   :-72.58  
 Class :character   Class :character   1st Qu.:-34.88   1st Qu.:-71.30  
 Mode  :character   Mode  :character   Median :-34.45   Median :-71.25  
                                       Mean   :-34.64   Mean   :-71.16  
                                       3rd Qu.:-34.10   3rd Qu.:-70.81  
                                       Max.   :-33.72   Max.   :-70.67  
     tipo          
 Length:49         
 Class :character  
 Mode  :character  
                   
                   
                   </code></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(<span class="fu">is.na</span>(agv_meta))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 16</code></pre>
</div>
</div>
</section>
<section id="se-busca-información-de-datos-parquet-y-arrow.-para-ello-consultamos-los-siguientes-enlaces." class="level2">
<h2 class="anchored" data-anchor-id="se-busca-información-de-datos-parquet-y-arrow.-para-ello-consultamos-los-siguientes-enlaces.">7. Se busca información de datos parquet y arrow. Para ello, consultamos los siguientes enlaces.</h2>
<p><a href="https://cran.r-project.org/web/packages/arrow/index.html">arrow</a> <a href="https://arrow.apache.org/docs/r/reference/write_parquet.html">parquet</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(arrow)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'arrow' was built under R version 4.1.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'arrow'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:utils':

    timestamp</code></pre>
</div>
</div>
</section>
<section id="se-guardan-archivos-en-formato-parquet-y-csv-para-comparar-las-performance-respecto-al-formato-.rds-y-.csv" class="level2">
<h2 class="anchored" data-anchor-id="se-guardan-archivos-en-formato-parquet-y-csv-para-comparar-las-performance-respecto-al-formato-.rds-y-.csv">8. Se guardan archivos en formato parquet y csv para comparar las performance respecto al formato .rds y .csv</h2>
<p>Empezamos exportando los datos en los formatos parquet y csv.</p>
<p>Para ello utilizamos el set de datos agromet_meta por conveniencia.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">write.csv</span>(agromet_meta,<span class="st">"agromet_meta.csv"</span>, <span class="at">row.names =</span> <span class="cn">FALSE</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">write_parquet</span>(agromet_meta, <span class="st">"agromet_meta.parquet"</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>readr<span class="sc">::</span><span class="fu">write_rds</span>(agromet_meta, <span class="st">"agromet_meta.rds"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Con el fin de comparar las performance entre estos formatos, importamos la librería ‘microbenchmark’, la cual cuenta el tiempo que se demora en correr una función en R registrandolo por defecto en milisegundos.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(microbenchmark)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'microbenchmark' was built under R version 4.1.3</code></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">opcion1 =</span> <span class="fu">read.csv</span>(<span class="st">"agromet_meta.csv"</span>),</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">opcion2 =</span> <span class="fu">read_parquet</span>(<span class="st">"agromet_meta.parquet"</span>) ,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">opcion3 =</span> <span class="fu">readRDS</span>(<span class="st">"agromet_meta.rds"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Unit: microseconds
    expr    min      lq      mean   median      uq     max neval
 opcion1 1986.2 2379.60  3164.760  3065.80  3659.3 10976.4   100
 opcion2 6579.5 7909.30 10303.940 10284.45 11337.3 38731.7   100
 opcion3  522.7  814.15  1012.012   995.45  1215.7  2778.4   100</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    setTimeout(function() {
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const cites = ref.parentNode.getAttribute('data-cites').split(' ');
    tippyHover(ref, function() {
      var popup = window.document.createElement('div');
      cites.forEach(function(cite) {
        var citeDiv = window.document.createElement('div');
        citeDiv.classList.add('hanging-indent');
        citeDiv.classList.add('csl-entry');
        var biblioDiv = window.document.getElementById('ref-' + cite);
        if (biblioDiv) {
          citeDiv.innerHTML = biblioDiv.innerHTML;
        }
        popup.appendChild(citeDiv);
      });
      return popup.innerHTML;
    });
  }
});
</script>
</div> <!-- /content -->



</body></html>